<template>
  <v-card class="mx-auto">
    <repo-bar :repositorys="repositorys" :symbols="symbols" />
    <repo-table :repositorys="repositorys" :symbols="symbols" />
  </v-card>
</template>

<script>
import repoTable from '../components/RepoTable.vue'
import repoBar from '../components/RepoBar.vue'

export default {

  /*
  ** COMPONENTS
  */
  components: {
    'repo-bar': repoBar,
    'repo-table': repoTable,
  },

  /*
  ** FETCH
  */
  fetch () {
    this.$store.dispatch('loadRepositorys')
  },

  /*
  ** COMPUTED
  */
  computed: {
    /*
    ** repositorys
    **
    ** Return an array of unvalued repositories
    */
    repositorys () {
      return this.$store.getters.repositorys
    },
    /*
    ** symbols
    **
    ** [ "BTC", "ETH", "LINK", â€¦ ]
    */
    symbols () {
      const showZeros = this.$store.state.repoZeroCoins
      const symbols = this.$store.getters.sortedUniqueSymbols
      return symbols.filter(s => showZeros || this.coinSum(s))
    },
  },

  /*
  ** METHODS
  */
  methods: {
    coinSum (symbol) {
      return this.$store.getters.coinSum(symbol)
    },
  },

}
</script>
